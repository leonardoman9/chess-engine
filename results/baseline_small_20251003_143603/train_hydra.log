[2025-10-03 14:36:03,889][__main__][INFO] - Using CPU
[2025-10-03 14:36:03,890][__main__][INFO] - Training Configuration:
[2025-10-03 14:36:03,892][__main__][INFO] - model:
  name: small
  conv_channels:
  - 32
  - 64
  - 128
  hidden_size: 256
  dropout: 0.1
  activation: relu
training:
  name: quick
  max_moves: 50
  game_timeout: 10.0
  games_per_episode: 5
  training_frequency: 2
  target_update_frequency: 20
  eval_frequency: 10
  eval_games: 3
  stockfish_depth: 1
  stockfish_time: 0.05
  log_frequency: 5
  checkpoint_frequency: 20
exploration:
  name: balanced
  strategy_type: linear
  epsilon_start: 1.0
  epsilon_end: 0.05
  epsilon_decay_steps: 1000000
  decay_type: linear
agent:
  name: small
  buffer_size: 1000
  min_buffer_size: 100
  batch_size: 32
  learning_rate: 0.0001
  gamma: 0.99
  tau: 0.005
  replay_type: standard
experiment:
  name: baseline_small
  description: Baseline CNN-DQN with small model for quick testing
  total_games: 100
seed: 42
device: auto
debug: false
verbose: true
paths:
  results_dir: results
  checkpoints_dir: checkpoints
  logs_dir: logs
  data_dir: data

[2025-10-03 14:36:03,892][__main__][INFO] - Initializing DQN Agent...
[2025-10-03 14:36:04,407][__main__][INFO] - Agent initialized with 2862593 parameters
[2025-10-03 14:36:04,407][__main__][INFO] - Initializing Self-Play Trainer...
[2025-10-03 14:36:04,409][__main__][INFO] - Using CPU
[2025-10-03 14:36:04,415][__main__][INFO] - Experiment configuration saved to /app/results/baseline_small_20251003_143603/experiment_config.yaml
[2025-10-03 14:36:04,415][__main__][INFO] - Using CPU
[2025-10-03 14:36:04,416][__main__][INFO] - Legacy experiment info saved to /app/results/baseline_small_20251003_143603/experiment_info.json
[2025-10-03 14:36:04,416][__main__][INFO] - Starting training: Baseline CNN-DQN with small model for quick testing
[2025-10-03 14:36:04,416][__main__][INFO] - Total games: 100
[2025-10-03 14:36:04,416][__main__][INFO] - Results directory: /app/results/baseline_small_20251003_143603
[2025-10-03 14:36:04,416][__main__][INFO] - 🚀 Starting training phase...
[2025-10-03 14:36:04,416][src.training.self_play][INFO] - Starting training for 100 games
[2025-10-03 14:36:06,127][src.training.self_play][INFO] - Game 5: timeout in 50 moves
[2025-10-03 14:36:06,129][src.training.self_play][INFO] - Episode 1: Games 5/100, Avg Reward: 3.420, Win Rate: 0.200, Epsilon: 1.000
[2025-10-03 14:36:07,732][src.training.self_play][INFO] - Game 10: timeout in 50 moves
[2025-10-03 14:36:07,732][src.training.self_play][INFO] - Running evaluation against Stockfish...
[2025-10-03 14:36:08,085][src.training.self_play][INFO] - Evaluation - Win: 0.000, Draw: 0.000, Loss: 1.000
[2025-10-03 14:36:08,085][src.training.self_play][INFO] - Episode 2: Games 10/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:09,606][src.training.self_play][INFO] - Game 15: timeout in 50 moves
[2025-10-03 14:36:09,607][src.training.self_play][INFO] - Episode 3: Games 15/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:11,131][src.training.self_play][INFO] - Game 20: timeout in 50 moves
[2025-10-03 14:36:11,132][src.training.self_play][INFO] - Running evaluation against Stockfish...
[2025-10-03 14:36:11,382][src.training.self_play][INFO] - Evaluation - Win: 0.000, Draw: 0.000, Loss: 1.000
[2025-10-03 14:36:11,444][src.training.self_play][INFO] - Checkpoint saved: /app/results/baseline_small_20251003_143603/checkpoints/checkpoint_game_20.pt
[2025-10-03 14:36:11,444][src.training.self_play][INFO] - Episode 4: Games 20/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:13,187][src.training.self_play][INFO] - Game 25: timeout in 50 moves
[2025-10-03 14:36:13,188][src.training.self_play][INFO] - Episode 5: Games 25/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:14,715][src.training.self_play][INFO] - Game 30: timeout in 50 moves
[2025-10-03 14:36:14,715][src.training.self_play][INFO] - Running evaluation against Stockfish...
[2025-10-03 14:36:14,870][src.training.self_play][INFO] - Evaluation - Win: 0.000, Draw: 0.000, Loss: 1.000
[2025-10-03 14:36:14,870][src.training.self_play][INFO] - Episode 6: Games 30/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:16,305][src.training.self_play][INFO] - Game 35: timeout in 50 moves
[2025-10-03 14:36:16,306][src.training.self_play][INFO] - Episode 7: Games 35/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:17,822][src.training.self_play][INFO] - Game 40: timeout in 50 moves
[2025-10-03 14:36:17,823][src.training.self_play][INFO] - Running evaluation against Stockfish...
[2025-10-03 14:36:17,989][src.training.self_play][INFO] - Evaluation - Win: 0.000, Draw: 0.000, Loss: 1.000
[2025-10-03 14:36:18,040][src.training.self_play][INFO] - Checkpoint saved: /app/results/baseline_small_20251003_143603/checkpoints/checkpoint_game_40.pt
[2025-10-03 14:36:18,041][src.training.self_play][INFO] - Episode 8: Games 40/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:19,490][src.training.self_play][INFO] - Game 45: timeout in 50 moves
[2025-10-03 14:36:19,491][src.training.self_play][INFO] - Episode 9: Games 45/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:21,343][src.training.self_play][INFO] - Game 50: timeout in 50 moves
[2025-10-03 14:36:21,344][src.training.self_play][INFO] - Running evaluation against Stockfish...
[2025-10-03 14:36:21,629][src.training.self_play][INFO] - Evaluation - Win: 0.000, Draw: 0.000, Loss: 1.000
[2025-10-03 14:36:21,629][src.training.self_play][INFO] - Episode 10: Games 50/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:23,040][src.training.self_play][INFO] - Game 55: timeout in 50 moves
[2025-10-03 14:36:23,040][src.training.self_play][INFO] - Episode 11: Games 55/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:24,875][src.training.self_play][INFO] - Game 60: timeout in 50 moves
[2025-10-03 14:36:24,875][src.training.self_play][INFO] - Running evaluation against Stockfish...
[2025-10-03 14:36:25,137][src.training.self_play][INFO] - Evaluation - Win: 0.000, Draw: 0.000, Loss: 1.000
[2025-10-03 14:36:25,191][src.training.self_play][INFO] - Checkpoint saved: /app/results/baseline_small_20251003_143603/checkpoints/checkpoint_game_60.pt
[2025-10-03 14:36:25,191][src.training.self_play][INFO] - Episode 12: Games 60/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:26,726][src.training.self_play][INFO] - Game 65: timeout in 50 moves
[2025-10-03 14:36:26,727][src.training.self_play][INFO] - Episode 13: Games 65/100, Avg Reward: 3.420, Win Rate: 0.200, Epsilon: 1.000
[2025-10-03 14:36:28,318][src.training.self_play][INFO] - Game 70: timeout in 50 moves
[2025-10-03 14:36:28,319][src.training.self_play][INFO] - Running evaluation against Stockfish...
[2025-10-03 14:36:28,566][src.training.self_play][INFO] - Evaluation - Win: 0.000, Draw: 0.000, Loss: 1.000
[2025-10-03 14:36:28,567][src.training.self_play][INFO] - Episode 14: Games 70/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:30,141][src.training.self_play][INFO] - Game 75: timeout in 50 moves
[2025-10-03 14:36:30,142][src.training.self_play][INFO] - Episode 15: Games 75/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:31,837][src.training.self_play][INFO] - Game 80: timeout in 50 moves
[2025-10-03 14:36:31,838][src.training.self_play][INFO] - Running evaluation against Stockfish...
[2025-10-03 14:36:32,005][src.training.self_play][INFO] - Evaluation - Win: 0.000, Draw: 0.000, Loss: 1.000
[2025-10-03 14:36:32,052][src.training.self_play][INFO] - Checkpoint saved: /app/results/baseline_small_20251003_143603/checkpoints/checkpoint_game_80.pt
[2025-10-03 14:36:32,052][src.training.self_play][INFO] - Episode 16: Games 80/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:33,684][src.training.self_play][INFO] - Game 85: timeout in 50 moves
[2025-10-03 14:36:33,684][src.training.self_play][INFO] - Episode 17: Games 85/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:35,195][src.training.self_play][INFO] - Game 90: timeout in 50 moves
[2025-10-03 14:36:35,195][src.training.self_play][INFO] - Running evaluation against Stockfish...
[2025-10-03 14:36:35,832][src.training.self_play][INFO] - Evaluation - Win: 0.000, Draw: 0.000, Loss: 1.000
[2025-10-03 14:36:35,832][src.training.self_play][INFO] - Episode 18: Games 90/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:37,367][src.training.self_play][INFO] - Game 95: timeout in 50 moves
[2025-10-03 14:36:37,367][src.training.self_play][INFO] - Episode 19: Games 95/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:38,871][src.training.self_play][INFO] - Game 100: timeout in 50 moves
[2025-10-03 14:36:38,872][src.training.self_play][INFO] - Running evaluation against Stockfish...
[2025-10-03 14:36:39,420][src.training.self_play][INFO] - Evaluation - Win: 0.000, Draw: 0.000, Loss: 1.000
[2025-10-03 14:36:39,479][src.training.self_play][INFO] - Checkpoint saved: /app/results/baseline_small_20251003_143603/checkpoints/checkpoint_game_100.pt
[2025-10-03 14:36:39,480][src.training.self_play][INFO] - Episode 20: Games 100/100, Avg Reward: 2.500, Win Rate: 0.000, Epsilon: 1.000
[2025-10-03 14:36:39,533][src.training.self_play][INFO] - Final model saved: /app/results/baseline_small_20251003_143603/final_model.pt
[2025-10-03 14:36:39,533][src.training.self_play][INFO] - Running final evaluation...
[2025-10-03 14:36:44,266][src.training.self_play][INFO] - 🎯 Running comprehensive ELO evaluation...
[2025-10-03 14:36:44,267][src.utils.elo_calculator][INFO] - 🎯 Starting Comprehensive ELO Evaluation
[2025-10-03 14:36:44,267][src.utils.elo_calculator][INFO] - Testing against 6 Stockfish configurations
[2025-10-03 14:36:44,267][src.utils.elo_calculator][INFO] - Games per configuration: 20
[2025-10-03 14:36:44,267][src.utils.elo_calculator][INFO] - Evaluating against Stockfish depth=1, 0.01s - Beginner level
[2025-10-03 14:36:44,267][src.utils.elo_calculator][INFO] - Playing 20 games...
[2025-10-03 14:36:45,057][src.utils.elo_calculator][INFO] -   Games 5/20: W0 D0 L5
[2025-10-03 14:36:45,797][src.utils.elo_calculator][INFO] -   Games 10/20: W0 D0 L10
[2025-10-03 14:36:46,452][src.utils.elo_calculator][INFO] -   Games 15/20: W0 D0 L15
[2025-10-03 14:36:47,199][src.utils.elo_calculator][INFO] -   Games 20/20: W0 D0 L20
[2025-10-03 14:36:47,199][src.utils.elo_calculator][INFO] - Final result vs beginner: W0 D0 L20 (Score: 0.000)
[2025-10-03 14:36:47,199][src.utils.elo_calculator][INFO] - ELO estimate vs beginner (400): 100
[2025-10-03 14:36:47,200][src.utils.elo_calculator][INFO] - Evaluating against Stockfish depth=1, 0.05s - Weak amateur
[2025-10-03 14:36:47,200][src.utils.elo_calculator][INFO] - Playing 20 games...
[2025-10-03 14:36:47,790][src.utils.elo_calculator][INFO] -   Games 5/20: W0 D0 L5
[2025-10-03 14:36:48,340][src.utils.elo_calculator][INFO] -   Games 10/20: W0 D0 L10
[2025-10-03 14:36:48,898][src.utils.elo_calculator][INFO] -   Games 15/20: W0 D0 L15
[2025-10-03 14:36:49,619][src.utils.elo_calculator][INFO] -   Games 20/20: W0 D0 L20
[2025-10-03 14:36:49,619][src.utils.elo_calculator][INFO] - Final result vs weak: W0 D0 L20 (Score: 0.000)
[2025-10-03 14:36:49,620][src.utils.elo_calculator][INFO] - ELO estimate vs weak (600): 100
[2025-10-03 14:36:49,620][src.utils.elo_calculator][INFO] - Evaluating against Stockfish depth=1, 0.1s - Amateur
[2025-10-03 14:36:49,620][src.utils.elo_calculator][INFO] - Playing 20 games...
[2025-10-03 14:36:50,294][src.utils.elo_calculator][INFO] -   Games 5/20: W0 D0 L5
[2025-10-03 14:36:51,005][src.utils.elo_calculator][INFO] -   Games 10/20: W0 D0 L10
[2025-10-03 14:36:51,906][src.utils.elo_calculator][INFO] -   Games 15/20: W0 D0 L15
[2025-10-03 14:36:52,750][src.utils.elo_calculator][INFO] -   Games 20/20: W0 D0 L20
[2025-10-03 14:36:52,751][src.utils.elo_calculator][INFO] - Final result vs amateur: W0 D0 L20 (Score: 0.000)
[2025-10-03 14:36:52,751][src.utils.elo_calculator][INFO] - ELO estimate vs amateur (800): 100
[2025-10-03 14:36:52,751][src.utils.elo_calculator][INFO] - Evaluating against Stockfish depth=1, 0.2s - Club player
[2025-10-03 14:36:52,752][src.utils.elo_calculator][INFO] - Playing 20 games...
[2025-10-03 14:36:53,541][src.utils.elo_calculator][INFO] -   Games 5/20: W0 D0 L5
[2025-10-03 14:36:54,526][src.utils.elo_calculator][INFO] -   Games 10/20: W0 D0 L10
[2025-10-03 14:36:55,002][src.utils.elo_calculator][INFO] -   Games 15/20: W0 D0 L15
[2025-10-03 14:36:55,593][src.utils.elo_calculator][INFO] -   Games 20/20: W0 D0 L20
[2025-10-03 14:36:55,594][src.utils.elo_calculator][INFO] - Final result vs club: W0 D0 L20 (Score: 0.000)
[2025-10-03 14:36:55,594][src.utils.elo_calculator][INFO] - ELO estimate vs club (1000): 200
[2025-10-03 14:36:55,594][src.utils.elo_calculator][INFO] - Evaluating against Stockfish depth=2, 0.1s - Intermediate
[2025-10-03 14:36:55,594][src.utils.elo_calculator][INFO] - Playing 20 games...
[2025-10-03 14:36:56,327][src.utils.elo_calculator][INFO] -   Games 5/20: W0 D0 L5
[2025-10-03 14:36:57,075][src.utils.elo_calculator][INFO] -   Games 10/20: W0 D0 L10
[2025-10-03 14:36:57,734][src.utils.elo_calculator][INFO] -   Games 15/20: W0 D0 L15
[2025-10-03 14:36:58,263][src.utils.elo_calculator][INFO] -   Games 20/20: W0 D0 L20
[2025-10-03 14:36:58,264][src.utils.elo_calculator][INFO] - Final result vs intermediate: W0 D0 L20 (Score: 0.000)
[2025-10-03 14:36:58,264][src.utils.elo_calculator][INFO] - ELO estimate vs intermediate (1200): 400
[2025-10-03 14:36:58,264][src.utils.elo_calculator][INFO] - Evaluating against Stockfish depth=2, 0.2s - Advanced
[2025-10-03 14:36:58,264][src.utils.elo_calculator][INFO] - Playing 20 games...
[2025-10-03 14:36:58,918][src.utils.elo_calculator][INFO] -   Games 5/20: W0 D0 L5
[2025-10-03 14:36:59,659][src.utils.elo_calculator][INFO] -   Games 10/20: W0 D0 L10
[2025-10-03 14:37:00,215][src.utils.elo_calculator][INFO] -   Games 15/20: W0 D0 L15
[2025-10-03 14:37:00,874][src.utils.elo_calculator][INFO] -   Games 20/20: W0 D0 L20
[2025-10-03 14:37:00,875][src.utils.elo_calculator][INFO] - Final result vs advanced: W0 D0 L20 (Score: 0.000)
[2025-10-03 14:37:00,875][src.utils.elo_calculator][INFO] - ELO estimate vs advanced (1400): 600
[2025-10-03 14:37:00,878][src.utils.elo_calculator][INFO] - 🎉 ELO Evaluation Complete!
[2025-10-03 14:37:00,878][src.utils.elo_calculator][INFO] - 📊 Estimated ELO: 250 (95% CI: -121-621)
[2025-10-03 14:37:00,878][src.utils.elo_calculator][INFO] - 📈 Overall Score: 0.000 (120 games)
[2025-10-03 14:37:00,880][src.utils.elo_calculator][INFO] - 💾 Evaluation results saved to /app/results/baseline_small_20251003_143603/elo_evaluation.json
[2025-10-03 14:37:00,881][src.training.self_play][INFO] - 🏆 Final ELO Rating: 250 (95% CI: -121-621)
[2025-10-03 14:37:00,881][src.training.self_play][INFO] - Final Evaluation - Win: 0.000, Draw: 0.000, Loss: 1.000
[2025-10-03 14:37:00,883][__main__][INFO] - ✅ Training phase completed!
[2025-10-03 14:37:00,884][__main__][INFO] - 💾 Starting file saving phase...
[2025-10-03 14:37:00,884][__main__][INFO] - ✅ Training history saved to: /app/results/baseline_small_20251003_143603/training_history.json
[2025-10-03 14:37:00,884][__main__][INFO] - ✅ Final model confirmed at: /app/results/baseline_small_20251003_143603/final_model.pt
[2025-10-03 14:37:00,885][__main__][INFO] - 🎯 Starting final evaluation phase...
[2025-10-03 14:37:53,012][__main__][INFO] - 🏆 Final Results:
[2025-10-03 14:37:53,013][__main__][INFO] -   Win Rate: 8.0%
[2025-10-03 14:37:53,013][__main__][INFO] -   Draw Rate: 84.0%
[2025-10-03 14:37:53,014][__main__][INFO] -   Loss Rate: 8.0%
[2025-10-03 14:37:53,014][__main__][INFO] - 🎮 Generating sample games...
[2025-10-03 14:37:53,036][src.utils.game_generator][INFO] - Generating 10 sample games...
[2025-10-03 14:37:53,036][src.utils.game_generator][INFO] - Playing game 1/10
[2025-10-03 14:37:53,329][src.utils.game_generator][INFO] - Playing game 2/10
[2025-10-03 14:37:53,627][src.utils.game_generator][INFO] - Playing game 3/10
[2025-10-03 14:37:53,906][src.utils.game_generator][INFO] - Playing game 4/10
[2025-10-03 14:37:54,082][src.utils.game_generator][INFO] - Playing game 5/10
[2025-10-03 14:37:54,301][src.utils.game_generator][INFO] - Playing game 6/10
[2025-10-03 14:37:54,561][src.utils.game_generator][INFO] - Playing game 7/10
[2025-10-03 14:37:54,830][src.utils.game_generator][INFO] - Playing game 8/10
[2025-10-03 14:37:55,045][src.utils.game_generator][INFO] - Playing game 9/10
[2025-10-03 14:37:55,279][src.utils.game_generator][INFO] - Playing game 10/10
[2025-10-03 14:37:55,506][src.utils.game_generator][ERROR] - Failed to save games summary: 'avg_agent_time'
[2025-10-03 14:37:55,506][src.utils.game_generator][INFO] - Generated 10 sample games successfully
[2025-10-03 14:37:55,506][__main__][INFO] - ✅ Generated 10 sample games in: /app/results/baseline_small_20251003_143603/sample_games
[2025-10-03 14:37:55,507][__main__][INFO] - 📊 Sample Games Summary:
[2025-10-03 14:37:55,507][__main__][INFO] -   Average moves per game: 50.0
[2025-10-03 14:37:55,507][__main__][INFO] -   1/2-1/2: 10 games
[2025-10-03 14:37:55,507][__main__][INFO] - 📈 Generating training plots...
[2025-10-03 14:37:55,518][__main__][INFO] - ✅ Training plots saved to: /app/results/baseline_small_20251003_143603/plots
[2025-10-03 14:37:55,518][__main__][INFO] - 🎉 All phases completed successfully!
